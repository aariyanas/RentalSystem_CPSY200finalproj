@page "/rentals"
@using CPSY200RentalSystem.domain
@using CPSY200RentalSystem.persistence

<main>
    <h3 id="mainTitle">Manage Rentals</h3><br>
    <button type="button" id="EQCAT1" @onclick="SwitchView" class="btn btn-primary btn-block">Create</button>
    <button type="button" id="EQCAT2" @onclick="SwitchView" class="btn btn-primary btn-block">Update</button>
    @if (menuButton == "updateRental")
    {
        <section id="container">
            <section id="search">
                <h5 id="SectionTitle">Search Inventory</h5>
                <p>Select type of search to be performed</p>
                <div class="radioContainer">
                    <form class="inputRadio">
                        <input type="radio" id="radioID" name="radioOptions" value="customerID" check="@IsSelected("customerID")" @onchange="SelectRadio" />
                        <label for="employeeID">Equipment ID</label><br>
                        <input type="radio" id="radioLast" name="radioOptions" value="custLastName" check="@IsSelected("custLastName")" @onchange="SelectRadio" />
                        <label for="radioLast">Category ID</label><br>
                        <input type="radio" id="radioAll" name="radioOptions" value="displayAll" check="@IsSelected("displayAll")" @onchange="SelectRadio" />
                        <label for="radioAll">Display All</label><br>
                    </form>
                </div>
                @if (radioSelection == "customerID")
                {
                    <div class="radioOptionContainer">
                        <form>
                            <label id="customerIDSection" for="employeeId">Enter Equipment ID:</label>
                            <input type="text" id="employeeId" class="form-control" @bind="custIdInput">
                        </form>
                        <button class="btn btn-primary" @onclick="() => DisplayRental(custIdInput, notUsed)">Search</button>
                        <br>
                        <p class="resultsHeader">Results:</p>
                        <select class="results">
                            <option>result1</option>
                        </select>
                    </div>
                }
                else if (radioSelection == "custLastName")
                {
                    <div class="radioOptionContainer">
                        <form>
                            <label for="employeeLast" id="customerLastSection">Enter Category ID:</label>
                            <input type="text" id="employeeAll" class="form-control" @bind="custLastInput">
                        </form>
                        <button class="btn btn-primary" @onclick="() => DisplayRental(notUsed, custLastInput)">Search</button>
                        <br>
                        <p class="resultsHeader">Results:</p>
                        <select class="results">
                            <option>result1</option>
                        </select>
                    </div>
                }
                else if (radioSelection == "displayAll")
                {
                    <div class="radioOptionContainer">
                        <p class="resultsHeader">Results:</p>
                        <select class="results" @onchange="SelectRental">
                            @foreach (Rental rental in rentalList)
                            {
                                <option value="@rental.Rental_id">Rental ID: @rental.Rental_id -- Customer: @rental.Customer.First_name[0].@rental.Customer.Last_name -- @rental.Equipment.Name</option>
                            }
                        </select>
                    </div>
                }
                else { }

            </section>
            <section id="addNedit">
                <h5 id="SectionTitle">Rental Details</h5>
                <p>Add, Update or Delete Inventory</p>
                <form>
                    <div>
                        <label for="inputID">Equipment ID:</label>
                        <input id="inputID" type="text" class="form-control" />
                    </div>
                    <div>
                        <label for="first">Category:</label>
                        <input id="first" type="text" class="form-control" />
                    </div>
                    <div>
                        <label for="last">Name:</label>
                        <input id="last" type="text" class="form-control" />
                    </div>
                    <div>
                        <label for="phone">Description:</label>
                        <textarea id="phone" type="textarea" class="form-control" />
                    </div>
                    <div>
                        <label for="email">Daily Rental Cost:</label>
                        <input id="email" type="number" class="form-control" placeholder="$" />
                    </div>
                </form>
                <div class="buttonContainer">
                    <div class="saveRemoveClear">
                        <button type="submit" class="btn btn-primary">Add</button>
                        <button type="submit" class="btn btn-primary">Delete</button>
                    </div>
                </div>
            </section>
        </section>
    }
    else
    {
        <section id="addNedit">
            <h5 id="SectionTitle">Add Category</h5>
            <form>
                <div>
                    <label for="inputID2">Category ID:</label>
                    <input id="inputID2" type="text" class="form-control" />
                </div>
                <div>
                    <label for="first">Category Name:</label>
                    <input id="first" type="text" class="form-control" />
                </div>
            </form>
            <div class="buttonContainer">
                <div class="saveRemoveClear">
                    <button type="submit" class="btn btn-primary">Add</button>
                </div>
            </div>
        </section>
    }
</main>





@code {
    RentalSystem rentalSystem = new RentalSystem();
    List<Equipment> equipmentList = RentalSystem.ListOfEquipment;
    List<Customer> customerList = RentalSystem.Customers;
    List<Rental> rentalList = RentalSystem.Rentals;

    List<Rental> displayRentals = new List<Rental>(); // stores rentals that match the search

    // Menu variables
    string radioSelection = "";
    string buttonSelection = "";
    string rentalId = "";
    string currentDate = "";
    string customerId = "";
    string rentalDate = "";
    string returnDate = "";
    string totalCost = "";

    string custIdInput;
    string custLastInput;
    string notUsed = "none";

    string selectedRentalId;
    Rental selectedRental;


    void SelectRadio(ChangeEventArgs e)
    {
        radioSelection = e.Value.ToString();
        StateHasChanged();
    }


    void SelectButton(ChangeEventArgs e)
    {
        buttonSelection = e.Value.ToString();
        StateHasChanged();
    }

    bool IsSelected(string option)
    {
        return radioSelection == option;
    }
    string menuButton = "updateRental";
    string saleButton = "inactive";

    public void SwitchView()
    {
        if (menuButton == "updateRental")
        {
            menuButton = "createRental";
        }
        else
        {
            menuButton = "updateRental";
        }
    }

    void SelectRental(ChangeEventArgs e)
    {
        selectedRentalId = e.Value.ToString();
        if (selectedRentalId != null)
        {
         selectedRental = rentalList.Where(r => r.Rental_id == selectedRentalId).FirstOrDefault();
        //ERROR - COMMENTED OUT FOR NOW
         // Code = selectedRental.Code = selectedRental
        // = selectedRental
        // = selectedRental
         //= selectedRental.Cost;
        }
    }

    void DisplayRental(string customerID, string lastName)
    {
        if (int.Parse(customerID) != 0)
        {

        }
        else if (lastName != "none")
        {

        }
        else { }
    }
}

